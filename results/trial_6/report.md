# 実験レポート: Trial 6 (物理制約強化と探索的進化)

## 1. エグゼクティブサマリー

本実験（Trial 6）の目的は、物理的制約（単調回復、境界条件）を厳格化した進化プロセスを通じて、物理的に妥当かつ高精度な風車後流モデルを発見することでした。
20世代にわたる進化と、その後の**物理的妥当性を考慮した厳格なベンチマーク**の結果、**第2世代（Gen 2）**のモデルが「ベスト有効モデル（Best Valid Model）」として選定されました。

- **ベスト有効モデル (Gen 2)**:
  - **MSE**: 0.000500
  - **物理ペナルティ**: **0.0** (完全準拠)
  - **Jensenモデル (MSE 0.000480)** に対する改善率: -4.17%
  - **Bastankhahモデル (MSE 0.000314)** に対する改善率: -59.4%

**重要な発見**:
純粋な精度（MSE）のみを追求した場合、Gen 4のモデル（MSE 0.000492）などがより高いスコアを示しましたが、これらは**物理ペナルティが非常に高い（Penalty > 100）**ため、過学習または非物理的な挙動（例: 遠方での再加速や振動）を含んでいると判断され、却下されました。
今回選定されたGen 2モデルは、既存モデル（Jensen）に肉薄する精度を持ちながら、物理法則（単調回復、非負性）を完全に満たす「最もバランスの取れた解」です。

## 2. 方法論

### 2.1 アプローチ
大規模言語モデル（LLM）を「変異・交叉演算子」として用いる進化的アルゴリズム（LLMSR）を採用しました。
- **物理制約**: 中心軸上での速度回復（単調性）、無限遠でのゼロ収束、非負性を評価関数（ペナルティ項）として導入。
- **進化戦略**: 探索（Exploration）と活用（Exploitation）のバランスを制御し、初期は多様性を、後半は微調整を重視しました。

### 2.2 評価指標と選定基準
モデル選定において、以下の2段階のフィルタリングを行いました：
1.  **物理的妥当性フィルタ**: 物理ペナルティが閾値（1.0）未満であること。
2.  **精度評価**: 上記を満たすモデルの中で、最も低いMSEを持つものを選定。

これにより、単なる数値合わせ（カーブフィッティング）ではなく、物理現象として妥当なモデルの発見を目指しました。

## 3. 結果分析

### 3.1 進化の履歴とトレードオフ
- **初期世代 (Gen 1-5)**: 多様な構造が提案されました。一部のモデル（Gen 4など）は非常に低いMSEを記録しましたが、物理ペナルティが大きく、物理的に不自然な挙動を示しました。
- **ベストモデルの選定**: 
  - **Gen 8**（進化中のベスト）: ペナルティ込みのスコアで優秀でしたが、再検証の結果、精度面でGen 2に劣りました。
  - **Gen 9**（高精度候補）: 以前の解析で高い精度を示しましたが、厳密な物理チェックではペナルティが発生し、今回の基準では「有効」とみなされませんでした。
  - **Gen 2**（最終選定）: ペナルティがゼロであり、かつ安定した精度を示しました。

### 3.2 ベストモデルの特定
最終的に選定されたベストモデル（Gen 2）は以下の通りです：

$$ \Delta U(x, r) = a \cdot (1 + b \cdot x)^{-2} \cdot (1 + c \cdot r^2)^{-1} \cdot (1 + d \cdot (1 + e \cdot x^2)^{-1}) $$

**係数**:
- $a \approx 0.170$
- $b \approx 0.016$
- $c \approx 4.199$
- $d \approx 0.344$
- $e \approx 0.025$

**選定理由**:
このモデルは、ベースとなる有理関数型の減衰（Seed 1由来）に、**補正項** $(1 + d \cdot (1 + e \cdot x^2)^{-1})$ を掛け合わせた形をしています。この補正項は、近接後流（$x$が小さい領域）での振る舞いを調整し、遠方では1に収束するため、物理的な整合性が保たれています。

## 4. 物理的解釈と議論

### 4.1 精度と物理性のトレードオフ
今回の結果は、**「物理制約を厳しくすると、見かけのフィッティング精度（MSE）は下がる」**というトレードオフを明確に示しています。
- Bastankhahモデル（ガウス型）は非常に高い精度（MSE 0.000314）を持ちますが、これはガウス関数という強力な仮定に基づいています。
- LLMが発見したGen 2モデルは、より一般的な代数式から出発し、物理制約を満たしつつJensenモデルと同等の精度（MSE 0.000500）に到達しました。これは、データのみから物理法則に近い構造を学習できたことを意味します。

### 4.2 モデル構造の解釈
Gen 2モデルの構造は、**「主流の減衰」×「近接場の補正」**と解釈できます。
- $(1+bx)^{-2}$: 遠方での運動量保存則に基づく減衰。
- $(1+cr^2)^{-1}$: 半径方向の広がり（ローレンツ関数型）。
- 補正項: 近接場での特異な挙動を吸収する役割を果たしています。

## 5. ベンチマーク比較

| モデル | MSE | Penalty | Jensen比改善率 | Bastankhah比改善率 | 判定 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **LLM Best Valid (Gen 2)** | **0.000500** | **0.0** | **-4.17%** | **-59.4%** | **採用** |
| LLM High Accuracy (Gen 4) | 0.000492 | 100.1 | -2.1% | -57.9% | 却下 (物理違反) |
| Bastankhah | 0.000314 | - | +34.6% | - | 参考 |
| Jensen | 0.000480 | - | - | -34.6% | 参考 |

提案モデル（Gen 2）は、Jensenモデルとほぼ同等の性能を持ちますが、Bastankhahモデルには及びませんでした。しかし、**「物理的に正しい挙動を保証する」**という点において、Gen 4のような過学習モデルよりも信頼性が高いと言えます。

## 6. 結論と今後の展望

Trial 6 では、物理制約を重視したモデル探索を行いました。
その結果、**「精度だけを追い求めると物理法則を破るモデルが選ばれる」**という危険性が浮き彫りになり、ペナルティ評価の重要性が再確認されました。

**結論**:
- LLMは物理的に妥当なモデル（Gen 2）を生成可能である。
- その精度はJensenモデルと同等レベルである。
- さらなる精度向上には、物理制約を満たしつつ柔軟性を持つ、より高度な関数形（例：スーパーガウス型の一般化など）の探索が必要である。

**推奨事項**:
1.  **ペナルティ関数の改良**: 物理制約を「ハード制約」ではなく、最適化プロセス内で滑らかに扱える「ソフト制約」として組み込む。
2.  **多目的最適化**: 精度（MSE）と物理性（Penalty）を別々の目的関数として扱うパレート最適解の探索。
