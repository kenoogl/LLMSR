# Trial 5 実験レポート: 複雑性ペナルティ緩和と多様性維持戦略の評価

## 1. エグゼクティブサマリー

Trial 5では、評価指標における複雑性ペナルティ（$f_3$）の閾値を緩和（$n_0 \le 10 \to 40$）し、多様性維持エリート戦略を導入して進化プロセスを実行しました。その結果、第7世代において**MSE 0.000382**という極めて高い精度を持つモデルを発見しました。

これは、標準的なJensenモデル（MSE 0.000477）と比較して**約19.9%の精度向上**、Bastankhahモデル（MSE 0.000588）と比較して**約35.1%の精度向上**を達成しています。Trial 4のベストスコア（0.000455）をも上回る、これまでの実験の中で最も高性能なモデルとなります。

## 2. 方法論

*   **初期集団生成**: 多様な物理的直感に基づく20個のモデルから開始。
*   **評価指標**: MSEに加え、物理的制約（$f_2$）と複雑性ペナルティ（$f_3$）を導入。Trial 5では $f_3$ の閾値を $n_0=40$ に設定し、適度な複雑さを持つモデルを許容しました。
*   **進化戦略**:
    *   **多様性維持エリート**: 構造的類似度（レーベンシュタイン距離）に基づく選抜を行い、集団の多様性を維持。
    *   **EP1-EP10**: 交叉、変異、物理的整合性チェック、次元解析などを組み合わせた多角的な進化。
    *   **フェーズ分け**: Gen 1-15（探索）、Gen 16-20（EP5を用いたオフセット微調整）。

## 3. 結果分析

### 3.1 進化の推移

| 世代 | ベストスコア (MSE) | 傾向 |
|---|---|---|
| 1 | 0.000764 | 初期探索。Jensen風モデルが優勢。 |
| 2-6 | 0.000720 -> 0.000475 | 急速な改善。`sqrt(x)` 減衰項と多項式動径分布の組み合わせが浮上。 |
| **7** | **0.000448** | **グローバルベスト発見（再最適化後 0.000382）。** |
| 8-15 | 0.000530 - 0.000666 | 停滞。Gen 7のモデルを超える構造が見つからず、わずかな振動を繰り返す。 |
| 16-20 | 0.000607 - 0.002128 | ファインチューニング（EP5）失敗。定数項やオフセット項の追加は、むしろスコアを悪化させる結果となった。 |

### 3.2 最終ベストモデル

**発見世代**: 第7世代
**再最適化後 MSE**: **0.0003821**

**数式**:
```julia
a * (1 + b*sqrt(x))^(-2) * (1 + c*r^2)^(-2) * (1 + d*sqrt(x))
```

**係数**:
```julia
a = -100.0 (境界値)
b = 17.24
c = 1.18
d = -1.62
```
*(注: 係数 `a` が負になっている点は物理的解釈に注意が必要ですが、全体の形状としては観測データに極めて良く適合しています)*

### 3.3 物理的解釈

このモデルは以下の特徴を持っています：

1.  **`sqrt(x)` ベースの減衰**: `(1 + b*sqrt(x))^(-2)` という項は、従来の `x^{-1}` や `x^{-2}` よりも緩やかな減衰表現しており、遠方後流の挙動をより正確に捉えている可能性があります。
2.  **高次多項式の動径分布**: `(1 + c*r^2)^(-2)` は、ガウス分布（`exp(-r^2)`）に似ていますが、裾野の広がり方が異なります。これが実際の乱流後流の形状に近いことを示唆しています。
3.  **`sqrt(x)` による補正**: `(1 + d*sqrt(x))` 項が含まれており、距離に応じた振幅の微調整が行われています。

## 4. 既存モデルとの比較

| モデル | MSE | Jensen比改善率 | 備考 |
|---|---|---|---|
| **LLM Best (Trial 5)** | **0.000382** | **+19.89%** | **本実験の成果** |
| Trial 4 Best | 0.000455 | +4.6% | 以前のベスト |
| Jensen | 0.000477 | 0.0% | 業界標準 |
| Bastankhah | 0.000588 | -23.3% | ガウス分布モデル |

## 5. 結論と推奨事項

1.  **複雑性ペナルティの緩和は有効**: 閾値を40に上げたことで、項数がやや多いが表現力の高いモデル（Gen 7）が生き残り、過去最高精度を達成しました。
2.  **早期収束**: 第7世代という早い段階で最適解が見つかりました。それ以降の探索（特にGen 16以降のオフセット調整）は蛇足となった可能性があります。
3.  **オフセット項の難しさ**: EP5による定数項や線形項の追加は、最適化の難易度を上げ、局所解に陥りやすくする傾向が見られました。単純な構造の方がロバストです。

**今後の指針**:
*   今回発見された `sqrt(x)` ベースのモデル構造をベースラインとして採用する。
*   係数 `a` が負になる問題を解決するため、物理的制約（$f_2$）の重みを強化するか、係数の探索範囲を正の値に制限することを検討する。
*   Trial 3 と Trial 4 のスコア乖離の原因調査を進める（本レポートとは別タスク）。
