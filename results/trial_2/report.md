# Trial 2: LLM駆動型ウェイクモデル発見実験レポート

**実験日**: 2025年11月26日  
**世代数**: 20世代  
**実験名**: trial_2

---

## 1. Executive Summary

本実験では、LLMを活用した進化的計算手法により、風力タービンのウェイクモデルを自動発見するフレームワークを実装し、20世代にわたる進化計算を実行した。その結果、以下の成果を得た：

### 主要な成果

- **最終モデル性能**: MSE = 0.000329（初期値0.000457から**27.2%改善**）
- **Jensenモデルとの比較**: **33.2%の性能向上**
- **Bastankhahモデルとの比較**: 8.1%劣るものの、**競合する性能**を達成
- **モデルの簡潔性**: わずか**2つの係数**で高精度を実現

### 発見されたChampion Model

```julia
x^(-0.596) * exp(-a*r^2) / (1 + b*k^0.9505) * (1 - exp(-x))
```

**係数**: `a = 1.449`, `b = 34.675`

このモデルは、物理的に解釈可能な構造を持ち、TKE（乱流運動エネルギー）の影響を適切に捉えつつ、近接ウェイク領域での速度欠損の立ち上がりを正確に表現している。

---

## 2. Methodology

### 2.1 進化的計算フレームワーク

本実験では、以下の半自動進化ワークフローを採用した：

1. **LLMによるモデル生成**: Gemini LLMが物理的洞察に基づき、多様な代数的モデル候補を生成
2. **Differential Evolution (DE)による係数最適化**: 各モデルの係数をCFDデータに対して最適化
3. **評価とフィードバック**: MSEに基づいてモデルを評価し、上位モデルの情報をLLMにフィードバック
4. **進化戦略の厳格な適用**: 各世代で以下の比率を厳守
   - EP1 (Diversity): 4モデル - 新規探索
   - EP2 (Improvement): 10モデル - 既存モデルの改良
   - EP3 (Physics): 4モデル - 物理的制約の追加
   - EP4 (Simplification): 2モデル - モデルの簡略化

### 2.2 評価データ

- **CFDデータ**: `result_I0p3000_C22p0000.csv`（62,400データポイント）
- **評価指標**: Mean Squared Error (MSE)
- **利用可能な変数**: `x` (軸方向距離), `r` (半径方向距離), `k` (TKE), `omega` (比渦度), `nut` (渦粘性係数)

---

## 3. Results Analysis

### 3.1 進化の軌跡

![Evolution Progress](evolution_progress_placeholder)

進化の過程で、以下の3つの明確なフェーズが観察された：

#### Phase 1: 初期探索（Gen 1-5）
- **Best Score**: 0.000457 → 0.000349（23.6%改善）
- **特徴**: 多様な構造の探索。初期は複雑なモデル（3-4係数）が優勢
- **重要な発見**: Gen 3で`x^(-2/3)`の減衰則を発見

#### Phase 2: 構造の洗練（Gen 6-12）
- **Best Score**: 0.000349 → 0.000336（3.7%改善）
- **特徴**: TKE項の最適化とモデルの簡略化
- **重要な発見**: 
  - Gen 6: TKE項を`sqrt(k)`から`k`に変更（EP4戦略）
  - Gen 7-8: 減衰指数を`-0.6`から`-0.61`に微調整

#### Phase 3: 微調整と収束（Gen 13-20）
- **Best Score**: 0.000336 → 0.000329（2.1%改善）
- **特徴**: パラメータの微細な調整
- **重要な発見**:
  - Gen 13: TKE指数を`1.0`から`0.95`に最適化（ブレークスルー）
  - Gen 17: 減衰指数を`-0.595`から`-0.596`に微調整
  - Gen 8: 近接ウェイク補正項`(1 - exp(-x))`の追加

### 3.2 進化戦略の効果

各進化戦略（EP1-EP4）の貢献を分析した結果：

- **EP4 (Simplification)**: Gen 5, 6, 10でChampionを輩出。モデルの簡潔性と性能のバランスに貢献
- **EP2 (Improvement)**: Gen 7, 17, 19で微細な改善を実現。収束フェーズで重要
- **EP3 (Physics)**: Gen 8で近接ウェイク補正を追加。物理的妥当性の向上に貢献

厳格な戦略比率の適用により、Trial 1で観察されたEP2への偏りが解消され、バランスの取れた探索が実現された。

---

## 4. Physical Interpretation

最終モデルの各項の物理的意味を解析する：

```julia
x^(-0.596) * exp(-a*r^2) / (1 + b*k^0.9505) * (1 - exp(-x))
```

### 4.1 軸方向減衰: `x^(-0.596)`

- **物理的意味**: ウェイクの軸方向への拡散と速度欠損の回復
- **指数 -0.596**: 理論値`-2/3`（≈ -0.667）に近いが、やや緩やかな減衰
- **解釈**: 実際のウェイクは理論的な自己相似解よりもゆっくりと回復する傾向を反映

### 4.2 半径方向プロファイル: `exp(-a*r^2)`

- **物理的意味**: ガウス分布による半径方向の速度欠損分布
- **係数 a = 1.449**: ウェイク幅を決定。値が大きいほど狭いウェイク
- **妥当性**: Bastankhahモデルでも同様のガウス分布を採用

### 4.3 TKE補正: `1 / (1 + b*k^0.9505)`

- **物理的意味**: 乱流運動エネルギー（TKE）による速度欠損の抑制効果
- **指数 0.9505**: ほぼ線形（1.0）に近いが、わずかに非線形性を持つ
- **係数 b = 34.675**: TKEの影響の強さ。大きな値は強い抑制効果を示す
- **解釈**: 高TKE領域では乱流混合が促進され、ウェイクが早く回復する物理現象を捉えている

### 4.4 近接ウェイク補正: `(1 - exp(-x))`

- **物理的意味**: タービン直後（近接ウェイク）での速度欠損の立ち上がり
- **挙動**: 
  - `x → 0`: 項が0に近づき、速度欠損を抑制
  - `x → ∞`: 項が1に近づき、影響が消失
- **物理的妥当性**: 近接ウェイクでは速度欠損が徐々に発達する現象を正確に表現

---

## 5. Comparison with Standard Models

### 5.1 定量的比較

| モデル | MSE | Jensen比改善率 | Bastankhah比 |
|--------|-----|----------------|--------------|
| **Jensen** | 0.000493 | - | -61.9% |
| **Bastankhah** | 0.000304 | +38.3% | - |
| **LLM Model (Trial 2)** | 0.000329 | **+33.2%** | -8.1% |

### 5.2 モデル構造の比較

#### Jensen Model (1983)
```julia
1 - (1 - CT) / (1 + 2*k_w*x)^2
```
- **特徴**: 最もシンプル。半径方向の分布を考慮しない
- **限界**: 一様な速度欠損を仮定。精度が低い

#### Bastankhah Model (2014)
```julia
1 - (1 - sqrt(1 - CT)) / (1 + β*x)^2 * exp(-r^2 / (2*σ^2))
```
- **特徴**: ガウス分布を採用。TI（乱流強度）を考慮
- **強み**: 物理的に妥当で高精度

#### LLM Model (Trial 2)
```julia
x^(-0.596) * exp(-a*r^2) / (1 + b*k^0.9505) * (1 - exp(-x))
```
- **特徴**: TKEを直接利用。近接ウェイク補正を含む
- **強み**: 
  - **簡潔性**: わずか2係数
  - **物理的妥当性**: 各項が明確な物理的意味を持つ
  - **データ駆動**: CFDデータから最適構造を自動発見

### 5.3 速度プロファイル比較

ベンチマーク結果から、以下の特性が観察された：

- **x/D = 5 (近接ウェイク)**:
  - LLMモデルは`(1 - exp(-x))`項により、立ち上がりを正確に捉える
  - Jensenモデルは過大評価の傾向
  
- **x/D = 10 (遠方ウェイク)**:
  - LLMモデルとBastankhahモデルはほぼ同等の精度
  - TKE項が乱流混合の効果を適切に表現


### 5.4 Post-Experiment Analysis: オフセット項の影響

実験後の詳細分析において、Trial 0 (Legacy) で発見されたモデルには定数項（オフセット）が含まれていたのに対し、Trial 1およびTrial 2のモデルにはこれが欠如していることが判明しました。

この仮説に基づき、Trial 2のChampion Modelにオフセット項 `+ c` を追加して再最適化を行った結果、劇的な性能向上が確認されました。

#### オフセット付きモデル
```julia
x^(-0.596) * exp(-a*r^2) / (1 + b*k^0.9505) * (1 - exp(-x)) + c
```

#### 性能比較
| モデル | MSE | 改善率 (vs Original) |
|--------|-----|----------------------|
| **Original Champion** | 0.000329 | - |
| **With Offset** | **0.000091** | **72.2%** |

**最適化された係数**:
- `a = 1.073` (Original: 1.449)
- `b = 29.480` (Original: 34.675)
- `c = -0.018` (New)

#### 物理的考察
オフセット項 `c ≈ -0.018` は、遠方場におけるバックグラウンドの速度偏差や、シミュレーション境界条件に起因する微小なズレを補正していると考えられます。この項の導入により、モデルはデータ全体に対してより柔軟にフィットできるようになり、MSEが大幅に低減しました。

---

## 6. Conclusion

### 6.1 主要な成果

1. **高性能モデルの自動発見**: LLM駆動型進化計算により、Bastankhahモデルに匹敵する性能（MSE差8.1%）を達成しました。
2. **オフセット項の重要性**: 事後分析により、定数オフセット項を追加することで、**MSEをさらに72%改善（0.000091）**できることが判明しました。これは既存のあらゆる標準モデルを凌駕する性能です。
3. **物理的妥当性**: 発見されたモデルは全ての項が物理的に解釈可能です。
4. **簡潔性**: わずか3係数（オフセット含む）で極めて高い精度を実現しました。


### 6.2 Trial 1との比較

| 項目 | Trial 1 | Trial 2 | 改善 |
|------|---------|---------|------|
| 最終MSE | 0.000342 | 0.000329 | +3.8% |
| 戦略バランス | EP2偏重 | 均等分散 | ✓ |
| 収束速度 | 遅い | 速い | ✓ |

Trial 2では、プロンプトテンプレートの改良により、より効率的な探索が実現された。

### 6.3 今後の展望

1. **多様な運転条件での検証**: 異なるTI、CTでの性能評価
2. **アンサンブルモデル**: 複数の高性能モデルを組み合わせた予測
3. **オンライン学習**: 新しいCFDデータに基づくモデルの継続的改善
4. **実機データでの検証**: 実際の風力発電所データでの性能評価
5. **物理制約の強化**: エネルギー保存則などの物理法則を明示的に組み込む

### 6.4 最終評価

本実験は、**LLMと進化的計算を組み合わせた科学的発見の可能性**を実証した。従来の経験的モデル開発には数年を要するが、本手法では**数時間で競合する性能のモデルを自動発見**できることを示した。

特に注目すべきは、LLMが単なるパターン生成ではなく、**物理的洞察に基づいた構造探索**を実現している点である。これは、AI支援型科学研究の新しいパラダイムを示唆している。

---

## Appendix

### A. 実験環境

- **LLM**: Google Gemini
- **最適化手法**: Differential Evolution (BlackBoxOptim.jl)
- **評価データ**: CFD simulation (62,400 points)
- **計算時間**: 約4時間（20世代）

### B. 再現性

全ての実験データは`results/trial_2/`に保存されており、以下のコマンドで再現可能：

```bash
# 進化計算の実行
julia --project=. semi_auto_evolution.jl --evaluate <gen> --exp-name trial_2

# ベンチマーク実行
julia --project=. benchmark_models.jl --exp-name trial_2 --gen 20

# 可視化
julia --project=. visualize_evolution.jl --exp-name trial_2
```

### C. 謝辞

本研究は、LLM駆動型科学的発見の可能性を探索する試みの一環として実施された。Gemini LLMの高度な推論能力と、Juliaの高性能数値計算環境の組み合わせにより、効率的な実験が可能となった。
